{% extends "redico/redico_base.html" %}
{% load static  %}
{% block title %}Redico - Rédaction & Reformulation de vos textes en Français{% endblock title %}
{% block content %}
<section class="doc_banner_area banner_creative1">
    <ul class="list-unstyled banner_shap_img">
        <li><img src="{% static 'img/new/banner_shap1.png' %}" alt=""></li>
        <li><img src="{% static 'img/new/banner_shap4.png' %}" alt=""></li>
        <li><img src="{% static 'img/new/banner_shap3.png' %}" alt=""></li>
        <li><img src="{% static 'img/new/banner_shap2.png' %}" alt=""></li>
        <li><img data-parallax='{"x": -180, "y": 80, "rotateY":2000}' src="{% static 'img/new/plus1.png' %}" alt="">
        </li>
        <li><img data-parallax='{"x": -50, "y": -160, "rotateZ":200}' src="{% static 'img/new/plus2.png' %}" alt="">
        </li>
        <li></li>
        <li></li>
        <li></li>
    </ul>
    <div class="container">
        <div class="doc_banner_content">
            <h2 class="wow fadeInUp">Welcome to Redico</h2>
            <p class="wow fadeInUp" data-wow-delay="0.2s">Rédaction & Reformulation de vos textes en Français</p>
            <form action="#" class="header_search_form">
                <div class="header_search_form_info">
                    <div class="form-group">
                        <div class="input-wrapper">
                            <input type='search' id="searchbox" autocomplete="off" name="search"
                                   placeholder="Search for Topics...."/>
                        </div>
                        <button type="submit" class="submit_btn btn_radious_45">Search</button>
                    </div>
                </div>


            </form>
        </div>
    </div>
</section>
<section class="doc_community_area">
    <img class="shap_one" src="{% static 'img/new/community_bg_shap_one.png' %}" alt="">
    <img class="shap_two" src="{% static 'img/new/community_bg_shap_two.png' %}" alt="">
    <div class="container">
        <div class="doc_title text-center">
            <h2 class="wow fadeInUp" data-wow-delay="0.2s">Les derniers textes</h2>
            <p class="wow fadeInUp" data-wow-delay="0.4s">Learn languages online with the world's best tutors
            </p>
        </div>
        <div class="forum_l_inner">
            <div class="forum_body">
                <ul class="navbar-nav topic_list infinite-container">
                    {% for demand in demands %}
                    <li class="infinite-item">
                        <div class="media">
                            <div class="media-body">
                                <div class="t_title">
                                    <a href="{% url 'demands:demand' demand.slug %}">
                                        <h4>
                                            {{demand.title}}
                                            {% if demand.verified %}
                                                <ion-icon name="checkmark-circle" role="img" class="md hydrated" aria-label="checkmark circle"></ion-icon>
                                            {% endif %}
                                        </h4>
                                    </a>
                                </div>
                                <a href="#">
                                    <h6><i class="icon_lightbulb_alt" aria-hidden="true"></i> {{demand.categoryName}}
                                    </h6>
                                </a>
                                <h6><i class="icon_clock_alt"></i> {{ demand.timestamp|timesince }}
                                </h6>
                            </div>
                            <div class="media-right">
                                <!--a class="count" href="#"><ion-icon name="create-outline"></ion-icon> 13</a-->
                                <!--a class="count" href="#"><ion-icon name="eye-outline"></ion-icon> 420</a-->
                            </div>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="doc_title text-center mt-40">
             {% if demands.has_next %}
            <a id="feed"  href="{% url 'demands:demands_feed' %}?page={{ demands.next_page_number }}" class="action_btn box_shadow_none wow fadeInUp infinite-more-link" data-wow-delay="0.2s" >Voir&nbsp;plus</a>
              {% endif %}
              <div class="loading" style="display: none;">
                Encore...
              </div>

        </div>

    </div>
</section>

<section class="doc_features_area">
    <img class="doc_features_shap" src="{% static 'img/new/shap_white.png' %}" alt="">
    <div class="container">
        <div class="doc_features_inner">
            {% for category in categories %}
            <div class="media doc_features_item wow fadeInUp" data-wow-delay="0.2s" data-wow-duration="0.6s">
                <img src="{% static category.icon %}" alt="">
                <div class="media-body">
                    <a href="{% url 'categories:demands' category.slug %}">
                        <h4>{{category.name}}</h4>
                    </a>
                    {% with total=category.posts_count %}
                    <p>{{ total }} post{{ total|pluralize }}</p>
                    {% endwith %}

                </div>
            </div>
            {% endfor %}

        </div>

        <div class="doc_title text-center pt_100">
            <h2 class="wow fadeInUp" data-wow-delay="0.2s">How it works</h2>
            <p class="wow fadeInUp" data-wow-delay="0.4s">Learn languages online with the world's best tutors
            </p>
        </div>


        <div class="row justify-content-center">
            <div class="col-lg-6 col-sm-6 aut">
                <div style="padding:56.25% 0 0 0;position:relative;">
                    <iframe src="https://player.vimeo.com/video/476467694?h=01dd3aeec4&title=0&byline=0"
                            style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0"
                            allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
                </div>
                <script src="https://player.vimeo.com/api/player.js"></script>
            </div>
        </div>
    </div>
</section>
{% endblock content %}
{% block javascript%}
    {{block.super}}
    <script src="{% static 'js/jquery.waypoints.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/infinite.min.js' %}" type="text/javascript"></script>
    <script>
    $(document).ready(function(){
        window.total_count = eval({{demands.count}});
        window.current_page = eval({{ demands.next_page_number }});
        $("#feed").click(function(){
          // window.feed();
        });
       window.feed = function(){
            $.ajax({
                url: "{% url 'demands:demands_feed' %}" ,
                type: 'GET',
                data: { "page": window.current_page },
                //dataType: 'json',
                cache: false,
                success: function(e,a,b){
                    //console.log(e);
                    $('.topic_list').append(e);
                    window.current_page++;
                },
                error: function(a,b,c,d){
                    console.log(b);
                }
            });
       };
        var infinite = new Waypoint.Infinite({
           element: $('.infinite-container')[0],
           handler: function(direction) {
               //window.feed();
           },
           onBeforePageLoad: function () {
                $('.loading').show();
           },
           onAfterPageLoad: function ($items) {
                $('.loading').hide();
           }
        });
     });
    </script>
{% endblock %}
